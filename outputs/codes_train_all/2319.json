{"2319": {"code": ["\n\n\n\n\n-----Example-----\n\nExample:\n\n\n\n\n\n\n\n\n\n-----Example-----\n\nExample:\n\nA test contains a test case with multiple test cases.\n\nExample:\n\nA test contains multiple test cases.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n 1 2 3 4", "\n\n\n\n-----Example-----\n\nExample:\n\nInput\n3\n4 3 4 3 4 4 4 5\n\n-----Example-----\n\nExample:\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n5\n\n\n\n-----Example-----\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n5 3 4 1", "\n\n\n\n\n-----Example-----\n\nExample:\n\nInput:\n\n1 0 0 1 0 1 1 1 1 1 1 0 2 1\n\n\n\n\n\n\n\n-----Example-----\n\n\n\n5 3 4 3\n3 4 3\n\n\n\n\n\n\n\n\nb$\n\n\n\n\n\n-----Example-----\n\n\n\n\n\n\n\n 2 2", "\n\n\n\n-----Example-----\n\nInput:\n\n1 1 2 3 4 5 4 7 7 8 8\n\n-----Example-----\n\nExample:\n\n\n\n-----Input-----\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nb\n\n-----Example-----\n\n\n\n 3\n5 4 1", "\n\n\n\n\n-----Example-----\n\n\n\n\n\n\nInput\n1 1 2 3 3 4 5 6 7 4 7 8 8 9 11 10\n\n-----Example-----\n\n\n\nQUESTION:\n\n\n\n\n5 3 4\n\n\n\n\n\n\n\n-----Example-----\n\nb$\n\n\n\n\n\n\n\n\n\n\n\n5 3 4 2 5", "\n\n\n\n-----Example-----\n\nInput\n3\n5 3\n4 3 3 5 3 1 4 3 1 5 5 5 5\n\n-----Example-----\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\na_i\n\n\n\n\n2 3 4 5\n4 2", "\n\n\n\n\n\n-----Example-----\n\nExample:\n\n\nn\n\n-----Example-----\n\nInput\n\n3\n4 3\n5 4 3\n5 3 3 4\n5 3 3 4 4 4 3 4 4 4 5 5 4 4 1 1 2 2\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n 3 2 2 4", "\n\n\n\n-----Example-----\n\nExample:\n\nInput\n3\n4\n5 1 3 4 5 5 6 6 7 7 7 8 9 9 11\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nb_1\n\n\n\n\n-----Example-----\n\n", "\n\n\n\n-----Example-----\n\nExample:\n\nInput\n3\n4 4 3 4 4 5 3 6 7 4 7 6\n\n-----Example-----\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n3 1 4 3 1\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nb\n\n\n\n-----Example-----\n\n\n5", "\n\n\n\n-----Example-----\n\nExample:\n\nInput\n3\n5 3 4 5 6 7 8 8 9 7\n5 7 7 7 6 8\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n5 3 4\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nb_1\nb_2\n\n\n\n\n5 4", "\n\n\n-----Example-----\n\n\n\n-----Example-----\n\nExamples:\n\n-----Example-----\n\nInput:\n\n\n-----Example-----\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n5 3\n\n-----Example-----\n\nExample:\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n 2 3 4 5 4 4", "\n\n\n\n-----Example-----\n\nExample:\n\nInput\n3\n5 4 3 4 5 5 5 5 6 6 7 7 7 7 8\n\n-----Example-----\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nb$\n\n\n\n\n\n\nb$\n\n-----Example-----\n\n\n\n\n5 3 4", "\n\n\n\n-----Example-----\n\nInput\n2\n3\n5\n4 4 3 4 5\n1 4 4 5\n1 4 4 3\n1 4 4 3\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n3 2 2 4 3 3 4 5\n\n\n\n\n\n\n\n\n\n\n\n\n\n\na$\n\n\n\n\n5 4", "\n\n\nInput:\n\n-----Example-----\n\nExample:\n\nInput:\n1 2 3 4 5 6 7 7 7 8 9 9 9 10 11 11 11 12\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nb$\n\n\n\n\n\n-----Example-----\n\n\n\n\n\n\n\n\n2 4 3", "\n\n\n\n\n-----Example-----\n\nInput:\n\n\n-----Example-----\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n5 3\n3 4 3\n5 1 3 4 1 4 3\n5 1 3 4\n\n\n-----Example-----\n\n\n\n\n\n\n\n\n\n\n\n\n\nb\n\n-----Example-----\n\n\n\n5 4", "\n\n\n\n-----Example-----\n\nExample:\n\nInput\n\n3\n4 4 4 4 4 4 4 4 4 4 4 4 4\n\n\n-----Example-----\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nb$\n\n\n\n\n\n\na_1, a_2, b_2\n\n\n 2", "\n\n-----Input-----\n\nExample:\n\n\n\n\n-----Example-----\n\n\n-----Output-----\n\n\n\n\n\n\n\n\n\n\n\n\n3 3 4 3 1 4 3 1 5 3 4 3 1 4\n1 4 7\n\n\n\n\n\n\n\n\n\n\n\nb$\n\n\n\n\n\n\n\n\n\n\n\n\n5 3 4 1", "\n\n\n\n-----Example-----\n\nInput:\n\nt\nn\nk\nn\nk\nk\nk\nk\nk\nk\nk\nk\nk\nk\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nb$\n\n\n\n\n\n\n\n\n\n\n\n\n-----Example-----\n", "\n\nExample:\n\n-----Example-----\n\nInput:\n\n1 5 2 3 4 5 3 3 4 4 5 5\n\n\n\n\n\n\n\n\n\n\n\n\n3\n4 1 5\n1 4 3 2 1\n\n-----Example-----\n\n\n\n\n\n\n\n\n\nb$\n\n\n\n\n\n\n\n\n\n\n\n\n\n-----Example-----", "\n\n-----Example-----\n\n\n\n\n-----Example-----\n\nInput:\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n5 3 4 3 1 4 3 5 5 3 1 4 5 3 1 3\n\n\n\n\n\n\n\n\n\nb$\n\n\n\n\n\n\n\n\n\n-----Example-----\n\nOutput:\n\n\n\n-----Input-----"], "prompt": "\nQUESTION:\nWe start with a permutation $a_1, a_2, \\ldots, a_n$ and with an empty array $b$. We apply the following operation $k$ times.\n\nOn the $i$-th iteration, we select an index $t_i$ ($1 \\le t_i \\le n-i+1$), remove $a_{t_i}$ from the array, and append one of the numbers $a_{t_i-1}$ or $a_{t_i+1}$ (if $t_i-1$ or $t_i+1$ are within the array bounds) to the right end of the array $b$. Then we move elements $a_{t_i+1}, \\ldots, a_n$ to the left in order to fill in the empty space.\n\nYou are given the initial permutation $a_1, a_2, \\ldots, a_n$ and the resulting array $b_1, b_2, \\ldots, b_k$. All elements of an array $b$ are distinct. Calculate the number of possible sequences of indices $t_1, t_2, \\ldots, t_k$ modulo $998\\,244\\,353$.\n\n\n-----Input-----\n\nEach test contains multiple test cases. The first line contains an integer $t$ ($1 \\le t \\le 100\\,000$), denoting the number of test cases, followed by a description of the test cases.\n\nThe first line of each test case contains two integers $n, k$ ($1 \\le k < n \\le 200\\,000$): sizes of arrays $a$ and $b$.\n\nThe second line of each test case contains $n$ integers $a_1, a_2, \\ldots, a_n$ ($1 \\le a_i \\le n$): elements of $a$. All elements of $a$ are distinct.\n\nThe third line of each test case contains $k$ integers $b_1, b_2, \\ldots, b_k$ ($1 \\le b_i \\le n$): elements of $b$. All elements of $b$ are distinct.\n\nThe sum of all $n$ among all test cases is guaranteed to not exceed $200\\,000$.\n\n\n-----Output-----\n\nFor each test case print one integer: the number of possible sequences modulo $998\\,244\\,353$.\n\n\n-----Example-----\nInput\n3\n5 3\n1 2 3 4 5\n3 2 5\n4 3\n4 3 2 1\n4 3 1\n7 4\n1 4 7 3 6 2 5\n3 2 4 5\n\nOutput\n2\n0\n4\n\n\n\n-----Note-----\n\n$\\require{cancel}$\n\nLet's denote as $a_1 a_2 \\ldots \\cancel{a_i} \\underline{a_{i+1}} \\ldots a_n \\rightarrow a_1 a_2 \\ldots a_{i-1} a_{i+1} \\ldots a_{n-1}$ an operation over an element with index $i$: removal of element $a_i$ from array $a$ and appending element $a_{i+1}$ to array $b$.\n\nIn the first example test, the following two options can be used to produce the given array $b$:  $1 2 \\underline{3} \\cancel{4} 5 \\rightarrow 1 \\underline{2} \\cancel{3} 5 \\rightarrow 1 \\cancel{2} \\underline{5} \\rightarrow 1 2$; $(t_1, t_2, t_3) = (4, 3, 2)$;  $1 2 \\underline{3} \\cancel{4} 5 \\rightarrow \\cancel{1} \\underline{2} 3 5 \\rightarrow 2 \\cancel{3} \\underline{5} \\rightarrow 1 5$; $(t_1, t_2, t_3) = (4, 1, 2)$. \n\nIn the second example test, it is impossible to achieve the given array no matter the operations used. That's because, on the first application, we removed the element next to $4$, namely number $3$, which means that it couldn't be added to array $b$ on the second step.\n\nIn the third example test, there are four options to achieve the given array $b$:  $1 4 \\cancel{7} \\underline{3} 6 2 5 \\rightarrow 1 4 3 \\cancel{6} \\underline{2} 5 \\rightarrow \\cancel{1} \\underline{4} 3 2 5 \\rightarrow 4 3 \\cancel{2} \\underline{5} \\rightarrow 4 3 5$; $1 4 \\cancel{7} \\underline{3} 6 2 5 \\rightarrow 1 4 3 \\cancel{6} \\underline{2} 5 \\rightarrow 1 \\underline{4} \\cancel{3} 2 5 \\rightarrow 1 4 \\cancel{2} \\underline{5} \\rightarrow 1 4 5$; $1 4 7 \\underline{3} \\cancel{6} 2 5 \\rightarrow 1 4 7 \\cancel{3} \\underline{2} 5 \\rightarrow \\cancel{1} \\underline{4} 7 2 5 \\rightarrow 4 7 \\cancel{2} \\underline{5} \\rightarrow 4 7 5$; $1 4 7 \\underline{3} \\cancel{6} 2 5 \\rightarrow 1 4 7 \\cancel{3} \\underline{2} 5 \\rightarrow 1 \\underline{4} \\cancel{7} 2 5 \\rightarrow 1 4 \\cancel{2} \\underline{5} \\rightarrow 1 4 5$;\nUse Standard Input format\nANSWER:\n"}}