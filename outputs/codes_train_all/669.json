{"669": {"code": ["\n\n\n\n\n\n\n1\u2264T\u226450$ \\le T \\le 50$\n1\u2264K\u22649 \\le K \\le K$\n2\u2264K$\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n-----Notes-----\n\n\nK$K$\n\n\n- 1\u2264T", "\nTest cases:\nQ$Q$\n\nConstraints-----\n\n\nK$K$\n\nExample:\n\nNadaca is a city with 3 cities\n\n\n\n\nK$K$\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nOutput-----\n\nNadaca is a country with 3 cities\n\n\n- A city connected by", "\nTest cases:\nK$K$\n\n---\n\n\n\n\nK$K$\n\n-----Notes-----\n\nThe first line:\n\n\n\n\n-----Notes-----\n\n\nK$K$\n\n\n\n\n\n\nK$K$\n\n\n\n\n\n\n\n1\u2026\n\nK$K$\n\n\n\n- Nadaca", "\nTest cases:\nK$K$\n\n---\n\n\n\nK$K$\n\nConstraints-----\n\n\n\n-----Notes-----\n\n\nK$K$\n\nK$K$\n\n\n\n\nK$K$\n\nInput-----\n\n\nK$K$\n\n\n\n1\n\n\n\n\n1\u2264T\u226450$1", "\n\n\n\n\n\nK$K$\n\n-----Notes-----\n\n\n\nNadaca is a country with a numbered city and a numbered city and an integer connected by his current city.\n\n-----Notes-----\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n0\u2026\n\n\n- T$T$ \\le", "\n\n\n\n\n\nK$K$\n\nTaking a test case:\nNadaca is a country with Nadaca cities\n\n\n\n\nK$K$\n\n\n\n\nK$K$\n\n\n\n\n\n\n\n\n\nK$K$\n\n-----Test Cities-----\n- \\le 1$1$\n- 1\ufffd", "\nTest case:\nNadaca is a country with a numbered cities.\nNadaca is a country with a numbered cities.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nK$K$\n\n-----Notes-----\n\n\n\n\n\n\n\n\n\n-----Notes-----\n\n\n\n\n\n- 1\u2264T\ufffd", "\n\n\n\n\n\nK$K$\n\n-----Notes-----\n\n\nK$K$\n\n-----Notes-----\n\nA test case:\n\nNadaca is a country with a city with a numbered cities.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nK$K$\n\n\n\n- 1\u2264T", "\nTest case:\nK$K$\n\nExample:\nNadaca is a country with Nadaca cities\nTest case:\nNadaca is a country with Nadaca cities\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n-----Notes-----\n\n\n1\u2264T\ufffd", "\nExample:\nNadaca is a country with Nadaca cities and K$K$\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nK$K$\n\n-----Notes-----\n\nNadaca is a country with Nadaca cities.\n\n\n\n\n\n\n1 \\le\n\n\n\n\n- 1\u2264T", "\n\n\n\n\n\n\n0.1\u2026\nNadaca is a country with a numbered cities.\n0.1\u2026\n\n\n\n\n\n\n\n\n\n\n- \\le 1$1$\n\nK$K$\n\nK$K$\n\n\n\nK$K$\n\n\n\n\n\u2264T\u2264", "\n\n\n\n\n\nK$K$\n\n-----Notes-----\n\n\nK$K$\n\n-----Notes-----\n\nNadaca is a country with a country with three cities.\n\n\n\n\n\n\n\nQ$Q$\n-\n\n\n\nK$K$\n\n\n\n\n\nK$K$\n\n\n1\u2264T\ufffd", "\n\n\n\n\n\nK$K$\n\nConstraints-----\n\n\n\nNadaca\n\n-----Notes-----\n\nK$K$\n\nK$K$\n\n-----Example-----\n\n\n\n\nK$K$\n\n\n\n\nK$K$\n\n\n\n\n\nK$K$\n\n-----Tests-----\n-1$\n- A valid", "\n\n\n\n\n\n\n\nConstraints-----\n\n1\u2264T\u226450$1 \\le 50$\n1\u2264K\u22649 \\le K$K$\n\n\n\n\n\n\n\n\nK$K$\n\n\n\n\n\n\n\n\n\nK$K$\n\n-----Notes-----\n\n\n- 1\u2264T\ufffd", "\nTest cases:\nK$K$\n\nTest cases:\n\n\nK$K$\n\nConstraints-----\n\n\n1\u2264T\u226450$ \\le 50$\n\n-----Constraints-----\n\n\n\n\n\n\n\nK$K$\n\n\n\n\n\n\n\nK$K$\n\n-----Notes-----\n\n\n \\le K$K$", "\n\n\n\n\n\n\nNadaca is a country with Nadaca and Nadaca is a country with Nadaca\n\nMilestone:\n\n\n\n\n\n\n\n\n\n\nK$K$\n\n-----Notes-----\n\n\n\n\n\n\n\n-----Notes-----\n\n\nK$K$\n\n\n\n- N$N$ \\", "\n\n\n\n\n\n\n- The first line contains a single integer T \\le T \\le T \\le K\n- The first line contains a single integer K \\le K\n\n\n\n\n\n\n\n\n\nK$K$\n\n-----Notes-----\n\n\n\n\n\n\n\n1\n\nInput-----\n- 1\u2264T\u226450$\n- 1", "\nTest case:\nQ$Q$\n\nConstraints-----\n\n\nK$K$\n\n-----Notes-----\n\n\n\n\n\nConstraints-----\nK$K$\n\n\n\n\nK$K$\n\n-----Notes-----\n\n\n\n\n\n\nK$K$\n\nInput-----\nK$K$\n\n\n\n\n,K,Q,T,Q", "\nTest cases:\nNadaca is a country with Nadaca cities\nNadaca is a country with Nadaca cities\n\n\n\n\n\n\n\n\n\n\n\n\n\nK$K$ \\le K$K$\n\n\n\n\n\n\n\n\n\n\n\n-----Example-----\n- The first line contains a single integer T \\le", "\n\n\n\n\n-----Notes-----\n\n\nK$K$\n\n-----Notes-----\n\nTadaca is a country with cities\n\nTadaca is a country with cities\n\nQUESTION:\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n1\u2264T\u226450$1 \\"], "prompt": "\nQUESTION:\nNadaca is a country with N$N$ cities. These cities are numbered 1$1$ through N$N$ and connected by M$M$ bidirectional roads. Each city can be reached from every other city using these roads.\nInitially, Ryan is in city 1$1$. At each of the following K$K$ seconds, he may move from his current city to an adjacent city (a city connected by a road to his current city) or stay at his current city. Ryan also has Q$Q$ conditions (a1,b1),(a2,b2),\u2026,(aQ,bQ)$(a_1, b_1), (a_2, b_2), \\ldots, (a_Q, b_Q)$ meaning that during this K$K$-second trip, for each valid i$i$, he wants to be in city ai$a_i$ after exactly bi$b_i$ seconds.\nSince you are very good with directions, Ryan asked you to tell him how many different trips he could make while satisfying all conditions. Compute this number modulo 109+7$10^9 + 7$. A trip is a sequence of Ryan's current cities after 1,2,\u2026,K$1, 2, \\ldots, K$ seconds.\n\n-----Input-----\n- The first line of the input contains a single integer T$T$ denoting the number of test cases. The description of T$T$ test cases follows.\n- The first line of each test case contains three space-separated integers N$N$, M$M$ and K$K$.\n- Each of the next M$M$ lines contains two space-separated integers u$u$ and v$v$ denoting a road between cities u$u$ and v$v$.\n- The next line contains a single integer Q$Q$.\n- Q$Q$ lines follow. For each i$i$ (1\u2264i\u2264Q$1 \\le i \\le Q$), the i$i$-th of these lines contains two space-separated integers ai$a_i$ and bi$b_i$.\n\n-----Output-----\nFor each test case, print a single line containing one integer \u2014 the number of trips Ryan can make, modulo 109+7$10^9+7$.\n\n-----Constraints-----\n- 1\u2264T\u226450$1 \\le T \\le 50$\n- 1\u2264N,M,K,Q\u22649,000$1 \\le N, M, K, Q \\le 9,000$\n- 1\u2264ui,vi\u2264N$1 \\le u_i, v_i \\le N$ for each valid i$i$\n- ui\u2260vi$u_i \\neq v_i$ for each valid i$i$\n- there is at most one road between each pair of cities\n- each city is reachable from every other city\n- 1\u2264ai\u2264N$1 \\le a_i \\le N$ for each valid i$i$\n- 0\u2264bi\u2264K$0 \\le b_i \\le K$ for each valid i$i$\n- the sum of N$N$ over all test cases does not exceed 9,000$9,000$\n- the sum of K$K$ over all test cases does not exceed 9,000$9,000$\n- the sum of M$M$ over all test cases does not exceed 9,000$9,000$\n- the sum of Q$Q$ over all test cases does not exceed 9,000$9,000$\n\n-----Subtasks-----\nSubtask #1 (20 points):\n- the sum of N$N$ over all test cases does not exceed 400$400$\n- the sum of K$K$ over all test cases does not exceed 400$400$\n- the sum of M$M$ over all test cases does not exceed 400$400$\n- the sum of Q$Q$ over all test cases does not exceed 400$400$\nSubtask #2 (80 points): original constraints\n\n-----Example Input-----\n3\n4 3 3\n1 2\n1 3\n1 4\n0\n4 3 3\n1 2\n1 3\n1 4\n1\n2 2\n4 3 3\n1 2\n1 3\n1 4\n1\n2 1\n\n-----Example Output-----\n28\n4\n6\nUse Standard Input format\nANSWER:\n"}}