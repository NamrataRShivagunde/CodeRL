{"798": {"code": ["\n\n\nLittle Red Riding Hood:\n\nLittle Red Riding Hood:\n\nLittle Red Riding Hood:\n\n\n\n\n\n\nLittle Red Riding Hood:\n\n\n\n\n\n\n\n\n\n\ns\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n3  2  3  2\n\n 1 ", "\n\n\n\n\n\n\nLittle Red Riding Hood's fairy godiad 2013, 10 Nov 2012\n\nLittle Red Riding Hood's fairy godiad 2013\n\nLittle Red Riding Hood's fairy godiad 2013\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n", "\n\n\nLittle Red Riding Hood:\n\nLittle Red Riding Hood:\n\nLittle Red Riding Hood:\n\n\n\n\n\nLittle Red Riding Hood:\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n -1  -2  -3  1", "\n\n\n\n\n\n\n\n\nThe grid:\n\n0 0 0 1 0 2\n\n0 0 0 1 1 1\n\n0 0 1 1 2 1 1\n\n0 0 1 1 1\n\n0 0 2 1\n\n\n\n\n\n\n\n\n \n\n\n\n\n\n\n\nLittle Red Riding Hood\n\n\n\n\n\n -2 -2", "\n\n\n\n\n\n\n\nLittle Red Riding Hood\n\nLittle Red Riding Hood\n\nLittle Red Riding Hood\n\nLittle Red Riding Hood\n\nLittle Red Riding Hood\n\n\n\n\n\n\n\n\n\n\n \n\n\n\n\n\n\n\n\n\n\n-1  2  2\n\n -2 ", "\n\n\n\nNOTE:\n\nLittle Red Riding Hood is not fully computed by Olympiad 2012\n\nNOTE:\n\n\n\n\n\n\n\n\n\n\n\n\n\n \u2264 k\n\n\n\nLittle Red Riding Hood is fully computed\n\n3\n\n\n\n\n\n\n \n\n\n\n -1 -2 -3 -", "\n\n\nLittle Red Riding Hood is carrying a basket with berries through the forest to the hood and then the food is carrying a path\n\n\n\n\n\n\n\n\n\n\n\n\n\n\ns.\n\n\n\n\n\n\n\nLittle Red Riding Hood is carrying a basket\n\n\n \n\n\n\n -2  3", "\n\n\n\n\n\n\n\n Riding Hood:\n\nLittle Red Riding Hood:\n\n\n\n\n\n berries through the forest\n\n2  2  3  2  3  \n\n\ns.\n\n\n\n\n\n\n\n\n\n\n\nLittle Red Riding Hood's fairy manufacturers:\n\n\n 1 ", "\nZonal Computing Olympiad 2012\n\nQUESTION:\n\nLittle Red Riding Hood\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\ns.\n\n\n\n\n\n\n\n\n\n\n\n\n\nLittle Red Riding Hood's fairy godiad 2013\n\n\n\n\n -2 ", "\n\n\nLittle Red Riding Hood:\n\nLittle Red Riding Hood:\n\n\n\n\n\n\n\n\n\n\n\n\n-1  2  3  2  2  \n-2  3  3  3  \n\n\n\n\n\n\n\n\n\n\n\n\n\n\nLittle Red Riding Hood\n\n\n\n\n -1 ", "\n\n\n\n\n\n\n\n\n\nLittle Red Riding Hood:\n\nLittle Red Riding Hood is carrying a basket with berries through the forest to her grandmother's house\n\nLittle Red Riding Hood is carrying a basket with berries through the forest\n\n\n\n\n\n\n\n\n \n\n\n\n\n\n\n\n\n\n\n\n", "\n\n\n\n\n\n\n\nLittle Red Riding Hood:\n\nLittle Red Riding Hood:\n\nLittle Red Riding Hood:\n\nLittle Red Riding Hood:\n\n\n\n\n\n\n\n\n\n\ns.\n\n\n\n\n\n\n\n\n\n\n\n-2 -2 -1 -2  \n\n\n -2 ", "\n\n\n\n\n\n\n\nLittle Red Riding Hood has a fairy wolf, and a berries house\n\nLittle Red Riding Hood has a fairy wolf, so you can\n\n\n\n\n\n\n \n\n\n\n\n\n\n\n\n\n\n\nLittle Red Riding Hood\n\n\n -2  2", "\n\n\n\n\n\n\n\n\n\n\n\nLittle Red Riding Hood:\n\nLittle Red Riding Hood is carrying a basket with berries through the forest to her grandmother's house\n\nLittle Red Riding Hood is carrying a basket with berries\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n", "\n\n\nLittle Red Riding Hood:\n\nLittle Red Riding Hood:\n\nLittle Red Riding Hood:\n\n\n\n\n\n\n\nLittle Red Riding Hood:\n\n\n\n\n\n\n \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nLittle Red Riding Hood:\n\n\n\n 1,", "\n\n\nLittle Red Riding Hood is backfilled by a fairy godmother's house\n\nLittle Red Riding Hood is backfilled by a fairy godmother's house\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n \n\n\n\n\n\n\n\nLittle\n\n\n\n\n-2  2 ", "\n\n\n\n\n\n\n\n\n\n\n\nLittle Red Riding Hood is carrying a basket with berries.\n\nLittle Red Riding Hood is carrying a basket with berries.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nLittle Red Riding Hood\n\n\n\n\n -1  2", "\n\n\nBecause of a grid:\n\n\n\n\n\n\n\n\n\n\n\n\n\n \u2264 k \u2264 N \u2264 N\n\n\n-2  1 -2  2  1  \n-1  2  1\n\n\n\n\n\n\n\n\n\n\n\n\nLittle\n\n\n\n\n\n-2  2 ", "\n\n\n\n\n\n\n\nLittle Red Riding Hood has a fairy gody house:\n\n3  2  2  1  2  2 \n\n\n\n\n\n\n\n\n\ns.\n\n\n\n\n\n\n\n\n\n\n\n\n\nLittle Red Riding Hood\n\nLittle Red Riding Hood\n\n\n 1", "\n\n\nLittle Red Riding Hood:\n\nLittle Red Riding Hood:\n\nLittle Red Riding Hood:\n\n\n\n\n\n\n\n\nLittle Red Riding Hood:\n\n \n\n\n\n\n \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n \n\n\n\n\n -1  3 -2 -"], "prompt": "\nQUESTION:\nZonal Computing Olympiad 2013, 10 Nov 2012\n\nLittle Red Riding Hood is carrying a basket with berries through the forest to her grandmother's house.  The forest is arranged in the form of a square N \u00d7 N grid of cells.  The top left corner cell, where Little Red Riding Hood starts her journey, is numbered (1,1) and the bottom right corner cell, where her grandmother lives, is numbered (N,N).  In each step, she can move either one position right or one position down.\n\nThe forest is full of dangerous wolves and she is looking for a safe path to reach her destination.  Little Red Riding Hood's fairy godmother has placed some special anti-wolf magical charms in some of the cells in the grid.  Each charm has a strength.  If the charm in cell (i,j) has strength k then its zone of influence is all the cells within k steps of (i,j); that is, all cells (i',j') such that |i - i'| + |j - j'| \u2264 k.  A cell within the zone of influence of a charm is safe from wolves.  A safe path from (1,1) to (N,N) is one in which every cell along the path is safe.\n\nLittle Red Riding Hood is carrying a basket with berries. In each cell, she drops some berries while pushing her way through the thick forest.  However, sometimes she is also able to pick up fresh berries.  Each cell is labelled with an integer that indicates the net change in the number of berries in her basket on passing through the cell; that is, the number of berries she picks up in that cell minus the number of berries she drops.  You can assume that there are enough berries in her basket to start with so that the basket never becomes empty.\n\nLittle Red Riding Hood knows the positions and strengths of all the magic charms and is looking for a safe path along which the number of berries she has in the basket when she reaches her grandmother's house is maximized.\n\nAs an example consider the following grid:\n\n3  3  2  4  3 \n2  1 -1 -2  2  \n-1  2  4  3 -3  \n-2  2  3  2  1  \n3 -1  2 -1  2  \n\nSuppose there are 3 magic charms, at position (1,2) with strength 2, at position (4,5) with strength 2 and one at position (4,2) with strength 1.  The positions within the zone of influence of these three charms are indicated in the three grids below using X's.  \n\nX  X  X  X  .         .  .  .  .  .         .  .  .  .  .\nX  X  X  .  .         .  .  .  .  X         .  .  .  .  .\n.  X  .  .  .         .  .  .  X  X         .  X  .  .  .\n.  .  .  .  .         .  .  X  X  X         X  X  X  .  .\n.  .  .  .  .         .  .  .  X  X         .  X  .  .  .\n\nPutting these together, the cells that are under the zone of influence of at least one charm are marked with X below.\n\nX  X  X  X  .\nX  X  X  .  X\n.  X  .  X  X\nX  X  X  X  X\n.  X  .  X  X\n\nHere are two examples of safe paths in this grid, marked using Y's.  \n\nY  Y  X  X  .          Y  X  X  X  .\nX  Y  X  .  X          Y  Y  X  .  X\n.  Y  .  X  X          .  Y  .  X  X\nX  Y  Y  Y  Y          X  Y  Y  Y  X\n.  X  .  X  Y          .  X  .  Y  Y\n\nAlong the first path, she accumulates 19 berries while on the second path she collects 16 berries.  You can verify that among all safe paths, the maximum number of berries she can collect is 19. \n\nYour task is to help Little Red Riding Hood find out if there is at least one safe path and, if so, compute the maximum number of berries she can collect among all safe paths (which may be a negative number, in which case it is the minimum number of berries she will lose among all safe paths).\n\n-----Input format-----\nLine 1: Two space separated integers N and M, giving the dimension of the grid and the number of magic charms, respectively\n\nLines 2 to N+1: These N lines desribe the grid.  Line i+1 contains N space separated integers, describing the net change in berries in the N cells along row i of the grid.\n\nLines N+2 to N+M+1: These M lines describe the magic charms.  Each of these lines has 3 integers: the first two integers describe the position of the charm in the grid and the third integer describes its strength.\n\n-----Output format-----\nThe first line of output must either consist of the word YES, if there are safe paths, or the word NO, if there are no safe paths. If the output on the first line is YES then the second line should contain a single integer giving the maximum number of berries Little Red Riding Hood can collect among all safe paths.  \n\n-----Sample Input-----\n5 3\n3 3 2 4 3 \n2 1 -1 -2 2  \n-1 2 4 3 -3  \n-2 2 3 2 1  \n3 -1 2 -1 2  \n1 2 2\n4 5 2\n4 2 1\n\n-----Sample Output-----\nYES\n19\n\n-----Test data-----\nIn all subtasks, you may assume that 2 \u2264 N \u2264 500.  Each value on the grid is guaranteed to have absolute value not more than 1000. \nLet K denote the maximum strength among all the magic charms.\n- Subtask 1 (30 marks) : 1 \u2264 M \u2264 10, 1 \u2264 K \u2264 1,000.\n- Subtask 2 (70 marks) : 1 \u2264 M \u2264 10,000, 1 \u2264 K \u2264 10.\n\n-----Live evaluation data-----\n- Subtask 1: Testcases 0,1,2,3,4.\n- Subtask 2: Testcases 5,6,7,8.\nUse Standard Input format\nANSWER:\n"}}