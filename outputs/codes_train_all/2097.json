{"2097": {"code": ["\nUse Standard Input format\nUse Standard Output format\n\n\n\n\nUse Standard Input format\n\n\n\n-----Note-----\n\nUse Standard Input format\n\n1\n\n\n-----Note-----\n\n\nUse Standard Input format\n\n\n\n\n\n\n\n-----Note-----\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nA, B, C, D, E", "\nDZY has a simple algorithm with standard input format\n\n\n\n\n\n\n\n1 2 2 3 2 3 3 4 4 3 4 3 4 3 2 3 3\n\n\n\n\n4\n\n2 1\n\n\n\n1 2 2 2 3 4 3\n\n\n\n\n\n\n\n\n\n\n\n\n\n1 2 3 2 2 3 4 3\n\n\n1 2", "\n\n\n\nUse Standard Input format\n\n\nDZY loves planting, and enjoys solving tree problems.\nUse Standard Input format\n\n\n\n\n2\n\n\n-----Note-----\n\nUse Standard Input format\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n1\n\n\nDZY loves planting, and", "\nUse Standard Input format\n\n\nUse Standard Output format\n\n\n\n\n-----Input-----\n\nUse Standard Input format\nINPUT:\n\n\n\n\n\n\n\n\n2 3 3 4 3 3 3\n\n\n-----Note-----\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n1 2 2 2 3\n4 2 2 3\n3 4\n\n\n\n2", "\nDZY uses Standard Input format\nUse Standard Input format\n\n\n\n-----Note-----\n\nUse Standard Input format\n\n\n\n\n\n\n\n\n\nDZY uses standard input format\n\n\n\n\n\n\n\n\n\n\nDZY has a heuristic for the maximum possible answer.\n\n\n\n\n\n\n\n1 2 3 2 3 4\n\n\n1 2", "\nUse Standard Input format\n\n\n\n-----Note-----\n\nUse Standard Input format\n\n\n\n\n\n\n-----Note-----\n\nUse Standard Input format\n\n1\n1\n2\n3\n4\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n-----Note-----\n\nDZY\n\n\n\nA\n1 2 3 2 4 3 4 4", "\nUse Standard Input format\n\nUse Standard Output format\n\n\n\n\nUse Standard Input format\n\n\n-----Input-----\n\nUse Standard Input format\n\nInput\n4\n1 2 3 2 2 3 3 4 3 3\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nDZY can solve\n\n\n\n\n1\n\n\nDZY can solve", "\nDZY is a generalized and simple search function\n\n-----Input-----\n\nUse Standard Input format\n\n\n\n\n\n\n\n\n\n\n\n1 2 2 2 3 4\n3 4 3\n\n\n\n\n\n\n\n\n\n\n\n-----Note-----\n\n\n\n\n\n\n\n\n\n\n1\n\n2\n\n2\n\n\n\nA:\n", "\nUse Standard Input format\n\n\n\nUse Standard Input format\n\n\n\n\n\n\n\n\n1 2 2 3 2 2 3 4\n\nOutput\n2\n\n\n-----Note-----\n\n\nStandard Input format\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n-----Note-----\n\nUse Standard Input format\n\n\n\n2\n\n-----Note-----\n\n\n1", "\nUse Standard Input format\n\n\n\n-----Note-----\n\nUse Standard Input format\n\n\n\n\n\n1\n\n\n2\n\n\n-----Note-----\n\nUse Standard Input format\n\n\n\n1\n\n\n1\n\n\n-----Note-----\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n1\n\n\n-----Output-----\n\n\n2", "\nUse Standard Input format\n\n\n\n\nUse Standard Input format\n\n\n\n\n-----Note-----\n\n\nUse Standard Input format\n\nQuestion:\n\n\n\n\n\n\n\n\n2\n\n\n\n\n-----Note-----\n\n\n\n\n\n\n\n-----Note-----\n\n\n\n\n\n\n\n\n\n1 2 3 2 2 3 3 4 3\n\n\n1", "\nDZY:\nUse Standard Input format\n\n\n\n\n\n\n\n1\n\n2\n\n3\n\n\nDZY:\n\nUse Standard Input format\n\n\n\n\n2\n\n3\n\n\n-----Note-----\n\n\n\n\n\n\n\n\n\n\n\n\n-----Note-----\n\n\n\n\n1\n\nDZY:\n\nDZ", "\nUse Standard Input format\n\n\n\n\nDZY loves planting, and he enjys solving tree problems.\nUse Standard Input format\n\n\n\n\n\n\nDZY loves planting, and he enjoys solving tree problems.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n-----Note-----\n\n", "\nUse Standard Input format\n\n\n\n-----Note-----\n\nUse Standard Input format\n\n\n\n\n\n\n1 2 3 2 4 3 4\n\n\n-----Note-----\n\nUse Standard Input format\n\n\n\n\n1 2 3 3\n\n\n\n\n\n\n\n\n\n\n\n\n\n-----Note-----\n\n\n\n\n\n1 2 2 3 4 3\n2 3", "\nUse Standard Input format\n\n\n\n\n\nDZY loves planting.\nUse Standard Input format\n\n\n\n1 2 3 2 4 3\n\n1 2 3 4\n\n\n\n\n4\n\n1 1 2 3 4\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n1 2 2 3 4 3 3 3 3\n\n\nDZY", "\nUse Standard Input format\n\n\n\n\n\n\n\n1 2 2 2 3 2 2 3 3 4 3 3\n1 2 2 3 3\n\n\n-----Note-----\n\nUse Standard Input format\n\n\n\n\n\n1\n\n\n-----Note-----\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n1\n\n\nDZY loves planting, but", "\nUse Standard Input format\n\n\n\n-----Note-----\n\nUse Standard Input format\n\n\n\n\n\n1 2 3 2\n3 4 3 4\n\nOutput\n2\n\n\n-----Note-----\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n1 2 2 3 2 3 2 3 4 3 3 4\n\n\n\n\n1 2 3", "\nUse Standard Input format\n\n\n\n\nDZY loves planting and enjoys solving tree problems.\nUse Standard Input format\n\n\n\n-----Note-----\n\n\n\n\n\n\n\n1\n\n\nDZY loves planting\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n1 2 2 3 3 4\n\n\n2 1", "\n\nUse Standard Input format\n\n\nUse Standard Input format\n\n\n\nDZY loves planting, he enjoys solving tree problems.\n\nUse Standard Input format\nANSWER:\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n1\n\n\n-----Note-----\n\n\n2 2", "\nUse Standard Input format\n\n1 1 2 2 3 3 4 4 4\n\nUse Standard Input format\n\n\n\n\n\n1 2 2 2 3\n1 2 3\n1\n\n\n\n\n1 2 2 3\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n1 1 2 3 4 3 4 4 3\n\n\n\n\n1 1 2 2 3 4\n1"], "prompt": "\nQUESTION:\nDZY loves planting, and he enjoys solving tree problems.\n\nDZY has a weighted tree (connected undirected graph without cycles) containing n nodes (they are numbered from 1 to n). He defines the function g(x, y) (1 \u2264 x, y \u2264 n) as the longest edge in the shortest path between nodes x and y. Specially g(z, z) = 0 for every z.\n\nFor every integer sequence p_1, p_2, ..., p_{n} (1 \u2264 p_{i} \u2264 n), DZY defines f(p) as $\\operatorname{min}_{i = 1}^{n} g(i, p_{i})$. \n\nDZY wants to find such a sequence p that f(p) has maximum possible value. But there is one more restriction: the element j can appear in p at most x_{j} times.\n\nPlease, find the maximum possible f(p) under the described restrictions.\n\n\n-----Input-----\n\nThe first line contains an integer n\u00a0(1 \u2264 n \u2264 3000).\n\nEach of the next n - 1 lines contains three integers a_{i}, b_{i}, c_{i}\u00a0(1 \u2264 a_{i}, b_{i} \u2264 n;\u00a01 \u2264 c_{i} \u2264 10000), denoting an edge between a_{i} and b_{i} with length c_{i}. It is guaranteed that these edges form a tree.\n\nEach of the next n lines describes an element of sequence x. The j-th line contains an integer x_{j}\u00a0(1 \u2264 x_{j} \u2264 n).\n\n\n-----Output-----\n\nPrint a single integer representing the answer.\n\n\n-----Examples-----\nInput\n4\n1 2 1\n2 3 2\n3 4 3\n1\n1\n1\n1\n\nOutput\n2\n\nInput\n4\n1 2 1\n2 3 2\n3 4 3\n4\n4\n4\n4\n\nOutput\n3\n\n\n\n-----Note-----\n\nIn the first sample, one of the optimal p is [4, 3, 2, 1].\nUse Standard Input format\nANSWER:\n"}}