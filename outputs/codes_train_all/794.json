{"794": {"code": ["\nCase 1:\n\n\n\n\n\n1 day:\nTanya was studying graph theory.\nA day:\n0 day\n\n-----Explanation-----\n\nExample case 1:\n\nExample case 1:\n\n\n-----Input-----\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n-----Explanation-----\n\n\n\nN$ is not", "\nExplanation-----\n\n\n\n\n\n\n\n1\n0\n0\n\n2\n0\n0\n0\n\n-----Explanation-----\n\n\n\n1 4 5\n2 3 4\n3 4 5\n3 4 5\n2 5 6\n\n\n\n:\n\n\n\n\n\n\n\n\n\n\n\n0\n0\n0\n\n- N \\le A_", "\nExample case 1:\n\n1 \\le 1 \\le 1 \\le 1 \\le 1 \\le 1 \\le 1 $\n\n\n\n\n\n\n\n\n\n\n\n0\n0\n0\n0\n\n-----Explanation-----\n\n cases were observed.\n\n\n\n\n\n\n\n\n\n-----Explanation-----\n\n\n\n\n\n N \\le T \\le A", "\n\n-----Input-----\nTanya was studying graph theory.\n\n-----Constraints-----\n\nTanya was studying graph theory.\n\n\n\n\n\n\n\n\n\n0\n0\n\n\n\n\n\n\n test cases are:\n\n\n\n\n\n\n\n0\n0\n\n\n\n\n\n\n input was the output of the first test case.", "\nExample case 1:\n\n-----Input-----\n\n0\n0\n0\n0\n\n-----Explanation-----\n\n\n\n-----Explanation-----\n\n\n\n\n-----Explanation-----\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n0\n0\n\n\n\n\n\n\n\nN - 1\n\n\n-----Explanation-----\n1 = 2 \\", "\nExample cases:\n1,000\n0\n0\n\n-----Explanation-----\nExample case 1: The two simple graphs with a number of tests.\n\n\n\n\n\n\n\n\n\n\n\n\n\n simple graphs with a number of test cases:\n\n\n\n\n\n\n\n0\n0\n\n\n\n2\n3\n0\n2\n\n\n\n2 \\cd", "\nExample Input-----\n1,000,000,000,000\n\n\n\n\n\n0\n\nExplanation-----\nThe two test cases are:\n\n-----Example Input-----\n1\n2\n3\n4\n0\n0\n\n-----Example Output-----\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n points were connected to the first graph.", "\nCase 1:\n\n\n\n\n\n\n\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n:\n\n\n\n test cases\n test cases\n\n\n\n\n\n\n\n\n\n-----Explanation-----\n\n\nOutput-----\n2 1 1\n4 2\n\n \\math", "\nExample Input-----\n- 1 \\le T \\le M \\le N \\le A_i \\le N$\n\n-----Example Input-----\n\n\n\n\n\n\n\n\n\n0\n\n\n\n\n test cases are:\n\n-----Explanation-----\n\n\n\n\n\n\n\n\n\n\n\n\n1\n3 2 2 2\n\n\n is a graph with a length", "\nExplanation-----\n\n\n\n\n\n-----Input-----\n\n1 \\le T \\le A_i \\le N$\n1 \\le M \\le A_i \\le N$\n\n-----Explanation-----\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n0\n0\n0\n\n\n2\n0\n0\n0\n2", "\nExample Input-----\n0\n0\n\n-----Explanation-----\nExample case 1: The two simple graphs with two graphs with two edges.\n\n\n-----Input-----\n\n\n\n\n\n\n\n-----Constraints-----\n\n\n\n\n\n\n\n simple graphs with two edges.\n\n\n\n\n\n\n\n\n\n1\n3\n0\n\n-----Explanation-----\n1:", "\nCase 1:\nCase 1:\n\n\n\n\n\n\n- \\mathrm{min} \\right \\left (0,0,0)\n\n-----Explanation-----\nExample case 1:\n\n\n\n\n\n\n\n\n\n\n\n\n\n1\n0\n0\n\n\n\n\n\n\n\n1\n1 2\n2\n1 2\n2\n\n2", "\nCase 1:\nA_2\nA_3\n\n-----Explanation-----\nExample case 1:\nThe two test cases were found in the test case 2:\n\n\n\n\n\n\n\n\n\n:\n\n\n\n\n was found:\n\n:\n\n\n\n\n\n\n\n\n\n\n\n1\n3 2\n4 2\n4\n\n\n1 \\le", "\nExample Input-----\n\n-----Explanation-----\nExample case 1: The two test cases\n\n\n\n\n\n\nTanya\n\n-----Input-----\n\n1 \\le N \\le M \\le N$\n2 1 1 1\n\n-----Constraints-----\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n is the first test case. The", "\nExample case 1: The two two simple graphs with the same vertices and edges.\nExample Input-----\n2 1 2 1 2 1\n\n\n\n\n\n\n\n\n\n\n\n\n simple graphs with the same vertices and edges.\n\n\n\n0\n0\n0\n\n\n-----Example Input-----\n\n\n\n\n\n\n\nT \\le 1 \\le N$: The two", "\nCase 1:\nT \\le N \\le M \\le N$\n\nCase 2:\n\n\n\n\n\n\n1\n\n:\n\n\n\n2\n1\n\n test cases are the same.\n\n\n\n\n\n\n\n\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n\n0\n\n3 \\le", "\n\nExample Input-----\n1\n2\n0\n0\n\n-----Explanation-----\nExample case 1: The two test cases\n\n\n\n\n\n\n\n\n\n\n\n4\n5 6 6\n3 4\n2 5\n\n-----Explanation-----\n\n\n\n\n\n\n\n\n\n\n\n-----Constraints-----\n\n\n\n\n\n-----Explanation-----\n\n2", "\nExample cases 1:\n\n-----Explanation-----\nExample case 1: The two two test cases\n\n\n\n\n\n\nTanya was studying graph theory.\n\n-----Explanation-----\n\nExample cases 1:\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n-----Explanation-----\n\n\n\n\n\nA_2 =", "\n\nCase 1:\n\n-----Explanation-----\nExample case 1: The two graphs with 2 edges between two graphs.\n\n-----Explanation-----\n\n\n\n\n\n\n\n\n\n\n\n\n\n1\n1\n1\n1\n2\n1\n1\n\n\n\n\n\n\n\n\n\n\n\n\n\nN\n4 2\n5\n\n1 \\le T", "\nExample Input-----\n1 1,000\n\n\n\n\n\n\n1 1 1 2 1 0 1 1\n2 2 1 1 1 1\n2 1 2 1\n3 1 1 1\n3 1\n2 2\n1\n:\n\n\n\n\n\n\n\n\n1\n0\n0\n\n-----Explanation-----\n\n\n\n\n\n\n\n-----Explanation-----\n2"], "prompt": "\nQUESTION:\nOne day, Tanya was studying graph theory. She is very inquisitive, so the following problem soon came to her mind.\nFind the number of undirected unweighted connected simple graphs with $N$ vertices (numbered $1$ through $N$) and $M$ edges, such that for each $i$ ($2 \\le i \\le N$), the shortest path from vertex $1$ to vertex $i$ is unique and its length is equal to $A_i$. In other words, for each $i$ ($2 \\le i \\le N$), there should be exactly one path with length $A_i$ between vertices $1$ and $i$, and there should be no paths with smaller length between these vertices.\nTwo graphs with $N$ vertices are distinct if we can find two vertices $u$ and $v$ such that there is an edge between these vertices in one graph, but not in the other graph.\nSince the answer could be very large, compute it modulo $1,000,000,007$ ($10^9 + 7$).\n\n-----Input-----\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\n- The first line of each test case contains two space-separated integers $N$ and $M$.\n- The second line contains $N - 1$ space-separated integers $A_2, A_3, \\ldots, A_N$.\n\n-----Output-----\nFor each test case, print a single line containing one integer \u2015 the number of graphs modulo $10^9 + 7$.\n\n-----Constraints-----\n- $1 \\le T \\le 1,000$\n- $2 \\le N \\le 10^5$\n- $N-1 \\le M \\le \\mathrm{min}\\left(2\\cdot 10^5, \\frac{N(N-1)}{2}\\right)$\n- $1 \\le A_i \\le N-1$ for each valid $i$\n- the sum of $N$ over all test cases does not exceed $2 \\cdot 10^5$\n- the sum of $M$ over all test cases does not exceed $2 \\cdot 10^5$\n\n-----Subtasks-----\nSubtask #1 (50 points): $M = N-1$\nSubtask #2 (50 points): original constraints\n\n-----Example Input-----\n3\n4 3\n1 2 1\n4 6\n1 2 1\n3 2\n2 2\n\n-----Example Output-----\n2\n0\n0\n\n-----Explanation-----\nExample case 1: The two graphs which satisfy all conditions are:\nUse Standard Input format\nANSWER:\n"}}