{"897": {"code": ["\n\n1\n1\nUse Standard Input format\n\n\n0\n\nUse Standard Output format\nANSWER:\n\n0\n\n\n\n\n\n\n\n\n\n\n\n\n\n0\n\n\n\n\n\n\n-----Example-----\n\n\n\n\n1\n8\n0\nUse Standard Output format\n\n-----Constraints-----\n\n-\n\n\n\n-----Example-----\n\n1", "\n1\n0\nUse Standard Input format\n\n\n\n1\n8\n0\nUse Standard Output format\nANSWER:\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n-----Example-----\n\n\nChef had an array A with length N but no elements were lost.\n\n-----Constraints-----\n\n\n\n\n\nChef had", "\n0\nUse Standard Input format\n\n1\n8\n0\nUse Standard Output format\nANSWER:\n\n\n\n\n\n\n\n\n\n\n\nChef had an array A with length N\n\n\n\n\n\n\n\n\n\n\n\n\n\nChef had an array A with length N\n\n5 2 3\n\n\n\n-----Constraints-----\n- 1 ", "\n1\n\n0\nUse Standard Input format\n\n\n\n\n\n\n- 1 \u2264 Ai \u2264 Ai-1 \u2264 Ai-1 \u2264 Ai-1 \u2264 Ai-1\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nChef decided to", "\n1\n8\n0\nUse Standard Input format\nANSWER:\n\n\n\n1\n0\nUse Standard Output format\n\n\n\n\n\n\n\nChef had an array A with length T\n\n\n\n\n\n\n\n\n\n\n\n\n-----Example-----\n\nUse Standard Output format\nInput:\n\n1\n2\n3\n\n\n\n\n\nChe", "\n0\nUse Standard Input format\n\n\n\n\n\n\n\n\n1\n5\n6\n5\n6\n0\nUse Standard Output format\n\n\n\n\n\n\nChef had an array A with length N and K denoted by N,000,000,000\n\n\n\n\n\n\n\n\n\n\n\n\nChef had an array A with length N\n", "\n0\nUse Standard Input format\n\n\n1\n8\n0\nUse Standard Output format\nANSWER:\n\n\n\n\n\n\n\n\n\n\n\nChef had an array A with length N\n\n\n\n\n\nChef had an array A with length N\n\n\n\n\n\nChef had an array A with length N\n\n\n\n\nChe", "\n0\nUse Standard Input format\n\n0\n1\n6\n0\nUse Standard Output format\nANSWER:\n\n\n\n\n\n\n\n\n\n\n\nChef had an array A with length N.\n\n\n\n\n\n\n1\n8\n\n\n\n\n\n\n\n\n1\n1\n10 3 8\n5 2 7\n6 2 3\n\n\n", "\n0\nUse Standard Input format\n\n\n\n1\n8\n0\nUse Standard Output format\nANSWER:\n\n\n\n\n\n\n\n\n\n- 1 \u2264 1 \u2264 1 \n\n\n\n\n\n\n\n\n\n\n-----Example-----\n\n\n\n\n- 1 \u2264 1 \n\n\n\n\nChef had an", "\n0\nUse Standard Input format\n\n\n0\nUse Standard Output format\n\n\n\n\n\nT\n0\n\n\n\n\n\nChef had an array A with length N\n\nChef had an array A with length N\n\n\n\n\n\n\n\n-----Example-----\n\n\n\n\n\n\nChef had an array A with length N\n\nChe", "\n0\nUse Standard Input format\n\n- 1\n1\n4\n0\nUse Standard Output format\nANSWER:\n\n1\n8\n\n\n\n\n\n\n\n\n\n\n\n\n\nChef had an array A with length N, then it was restored.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n1\n5 2 3\n\n1", "\n0\nUse Standard Input format\n\n\n\n\n\n\n\n1\n1\n15\n0\n\nUse Standard Output format\n\n-----Constraints-----\n- 1 \u2264 T \u2264 N\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n-----Example-----\n\n\n\n\n\n\n\nChef had an array A with length N\n\nC", "\n0\nUse Standard Input format\n\n1\n0\nUse Standard Output format\nANSWER:\n\n\n1\n8\n0\nUse Standard Input format\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n1\n\n5\n5\n6\n1\n\n\n\n\n-----Example-----\n\n\n\n\n\n\nChef had an array A with length", "\n0\nUse Standard Input format\n\n\n0\nUse Standard Output format\n\n\n\n\n\n\nChef had an array A with length N and K denoted by N, R,..., AN\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n 2 2 3 5 5\n5 2 2 3 4\n6 2 2 3\n5 4 3\n\n\nC", "\n0\nUse Standard Input format\n\n1\n5\n0\nUse Standard Output format\nANSWER:\n\n\n\n\n\n\n\n\n\n\n1\n10\n0\n\n\n\n1\n\n\n\n\n1\n8\n0\nUse Standard Output format\n\n\n\n\n1\n0\n1\n1\n4 2 2 5 6\n\n\n\n\nChef", "\n1\n8\n0\nUse Standard Input format\nANSWER:\n\n\n\n\n\n\n\n\n\n\n1\n3\n4 3\n5 2 4\n6 2 3\n5 3 5\n6 2 2\n\n\n\n\n\n\n\n\n\n\n\n\n\nChef had an array A with length T\n\n\n\n\nChef had an array A with", "\n1\n8\n0\nUse Standard Input format\n\n\n1\n0\nUse Standard Output format\nANSWER:\n\n1\n\n\n\n\n\n\n1\n\n\n\n\n\n\n1\n\n\n\n\n\n1\n8\n\n\n\n\n-----Constraints-----\n\n- 1 \u2264 L\n- 1 \n\n\n\n\n\n\n\n\n1", "\n0\nUse Standard Input format\n\n0\n1\n8\n0\nUse Standard Output format\nANSWER:\n\n\n\n\n\n\n\n\n\n\n\nChef had an array A with length N\n\n\n\n\n\n-----Example-----\n\n\n\n\n\n\n\n\nChef had an array A with length N\n\n\n\n\nChef had an", "\n0\nUse Standard Input format\n\n\n\n0\nUse Standard Output format\nANSWER:\n\n\n\n\n\n\n\n\n\n\n\n\nChef had an array A with length N\n\n-----Constraints-----\n\n\n\n\n\n\n\n\n-----Example-----\n\nUse Standard Input format\n\n- 1 L 1 R\n\n\n\n\nChef had an array", "\n0\nUse Standard Input format\n\n\n1\n8\n0\nUse Standard Output format\nANSWER:\n\n\n\n\n\n\n\n\n\n\n\nChef had an array A with length N\n\n\n\n\n\n\n\n\n\nChef had an array A with length N but no elements were lost.\n\n\n\n\nChef had an array A with"], "prompt": "\nQUESTION:\nChef had an array A with length N, but some of its elements got lost. Now, each element of this array is either unknown (denoted by -1) or a positive integer not exceeding K.\nChef decided to restore the array A by replacing each unknown element by a positive integer not exceeding K.\nHowever, Chef has M restrictions that must hold for the restored array. There are two types of restrictions:\n\n- I L R, meaning that for each i such that L < i \u2264 R, the condition Ai - Ai-1 = 1 should be satisfied.\n- D L R, meaning that for each i such that L < i  \u2264 R, the condition Ai - Ai-1 = -1 should be satisfied.\n\nChef would like to know the number of ways to restore the array while satisfying all restrictions, modulo 109+7.\n\n-----Input-----\n- The first line of the input contains a single integer T denoting the number of test cases. The description of T test cases follows.\n- The first line of each test case contains three space-separated integers N, M and K.\n- The second line contains N integers A1, A2, ..., AN.\n- Each of the following M lines contains one restriction in the form I L R or D L R.\n\n-----Output-----\nFor each test case, print a single line containing one integer - the number of ways to restore the array modulo 109+7.\n\n-----Constraints-----\n- 1 \u2264 T \u2264 10\n- 1 \u2264 N, M \u2264 100,000\n- 1 \u2264 K \u2264 1,000,000,000\n- 1 \u2264 L < R \u2264 N\n- 1 \u2264 Ai \u2264 K or Ai = -1 for each valid i\n- 1 \u2264 sum of N over all test cases \u2264 500,000\n- 1 \u2264 sum of M over all test cases \u2264 500,000\n\n-----Example-----\nInput:\n\n3\n4 2 10\n2 3 5 4\nI 1 2 \nD 3 4\n5 2 10\n-1 -1 -1 -1 -1\nI 1 3\nD 3 5\n6 2 2\n-1 -1 -1 -1 -1 -1\nI 1 4\nD 4 6\n\nOutput:\n\n1\n8\n0\nUse Standard Input format\nANSWER:\n"}}