{"1453": {"code": ["\n\n?!?!\n\n-----Constraints-----\n1 0 1 1 1\n\n-----Explanation-----\n1 0 0 1 1\n\n-----Subtasks-----\n1 1 1 1\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n1\n\n-----Explanation-----\n\n\n\n1$\n\n\n-----Explanation-----\n\n+", "\n\n!!!!!!\n\n\n\n-----Explanation-----\n\n\n\n-----Subtasks-----\n\n\n\n-----Constraints-----\n\n1\n\n-----Explanation-----\n\n\n\n\n\n-----Explanation-----\n\n\nK\n\n!!!!!!!!!!!!!\n1\n\n\n\n1\n\n-----Explanation-----\n\n2", "\n\n\n\n\n-----Explanation-----\n\n\n\n-----Input-----\n\n1\n1\n1\n1\n1\n1\n1\n1\n2\n1\n1\n1\n1\n\n-----Explanation-----\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n-----Explanation-----\n\n\n\n \\le K$\n\n", "\n\n?!?!?\n\n-----Explanation-----\n1:\n1 1 1 1 1 1 1 1 1 1 1 1 1\n\n-----Explanation-----\n2\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n!!!!\n\n\n1$\n\n1$\n\n\n\n1$\n\n-----Explanation-----\n\n \\le [1", "\n\n\n\n\n-----Constraint-----\n\nA query of the first type\n\n\n\n-----Constraints-----\n\nA query of the second type\n\n\n-----Explanation-----\n\n\n\n\n-----Explanation-----\n\n\n\n\n\n-----Explanation-----\n\n\n\n\n\n\n\n!\n\n\n\n\n1 \\le K$\n\n-----Constraints-----\n\n \\le", "\n\n\n?!!\n\n\n\n-----Explanation-----\n\n\n\n-----Explanation-----\n1 N 0 1 1\n\n-----Constraints-----\n\n1 1 1 1 1\n\n-----Explanation-----\n\n\n\n\n\n-----Input-----\n\n\n\n\n\n\n2\n\n-----Explanation-----\n\n\n\n\n1\n\n-----Explanation-----\n\n \\le", "\n\n!!!!!!\n\n-----Explanation-----\n\n\n\n\n-----Explanation-----\n\n\n\n\n\n\nK\n\n\n\n-----Explanation-----\n\n\n1 \\le N \\le 10^5$\n\n\n-----Explanation-----\n\n\n\n1$\n\n\n1$\n\n-----Explanation-----\n\n1$\n\n \\le [", "\n\n\n\n\n\n-----Constraints-----\n\n\n\n?!!\n\n-----Explanation-----\n\nChef has a sequence of subsequences with length $N \\le K$:\n!!!!!!\n\n-----Constraints-----\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n-----Input-----\n\n1\n\n \\le [1,", "\n\n?!!?!?\n\n-----Explanation-----\n2 (70 points):\n1 1 1 1 1 1 1\n\n-----Constraints-----\n2 1 1 1 1\n\n-----Constraints-----\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n-----Explanation-----\n\n\n\n1$\n\n\n \\le N$; $1", "\n\n-----Input-----\n\n\n\n\n-----Constraints-----\n\n\n\n\n\n-----Explanation-----\n\n-----Input-----\nChef has a sequence of K \\le N \\le 10^5$\n\n\n\n\n\n\n\n\n\n\n\n!!\n\n\n!?!!\n\n\n\n\n1\n\n-----Explanation-----\n\n \\le [1", "\n\n\n\n\n\n\n-----Constraints-----\nK1!!?!\n\n-----Explanation-----\n\n-----Input-----\n0\n1\n1\n\n-----Constraints-----\n\n1\n\n-----Constraints-----\n\n1\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n1 1 1 1\n\n-----Explanation-----\n\n\n\n \\le K", "\n\n\n\n\n\n\n\n-----Constraints-----\nK \\le N \\le 10^5$\n\n-----Explanation-----\n\n\n-----Explanation-----\n\n\n\n-----Subtasks-----\n\n\n\n\n-----Constraints-----\n\n\n\n\n\n\n\n1$\n\n-----Explanation-----\n\n\n\n\n\n1$\n\n\n\n-----Explanation-----\n 2", "\n\n\n\n\n\n\n-----Explanation-----\n\n\n\n?!!?\n\n-----Explanation-----\n\n\n\n\n\n\n\n-----Explanation-----\n\n\n1 \\le K$\n\n-----Explanation-----\n\n\n\n-----Constraints-----\n\n\n\n\n\n\n\n1 \\le A_1$\n\n-----Explanation-----\n\n\n\n \\le", "\n\n?!!?\n\n-----Explanation-----\n\n\n\n\n-----Subtasks-----\nK\n\n-----Constraints-----\n\n\n\n\n\n-----Explanation-----\n\n\n\n\n\n\n\n-----Constraints-----\n1 \\le 1$\n\n-----Explanation-----\n\n\n\n1$\n\n\n\n\nK$\n\n\n\n\n\n-----Explanation-----\n", "\n\n-----Input-----\n\n!!\n\n-----Constraints-----\n\nA query of the second type \n\n\n-----Explanation-----\n\n\n\n\n\n\n-----Explanation-----\n\n\n\n-----Constraints-----\n\n\n\n\n\n\n-----Subtasks-----\n\n\n\n\n\n1$\n\n\n\n\n\n1$\n\n\n\n\n-----Explanation-----\n2", "\n\n\n\n\n\n-----Input-----\n\n\n?!!\n\n-----Explanation-----\n\nChef:\n\n-----Constraints-----\n\n3\n\n-----Input-----\n3\n3\n\n\n\n-----Constraints-----\n\n\n\n\n\n\n\n\n\n\n\n\n1$\n\n\n\n\n\n\n\n\n\n\n-----Explanation-----\n\n2=", "\n\n\n\n\n\n\n\n\n1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n\n-----Explanation-----\n2\n1 1 1 1 1 1 1\n\n-----Explanation-----\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n-----Explanation-----\n\n1$\n\n\n \\le N$; $1", "\n\n\n?!!\n\n\n\n\n-----Input-----\nK \\le N \\le K$\n\n-----Constraints-----\n\n\n-----Explanation-----\n\n\n\n-----Constraints-----\n\n?!!!!!\n\n-----Subtasks-----\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n-----Explanation-----\n!!!!?!", "\n\n\n?!?!?\n\n\n\n\n\n\n1 0 0 1 1\n2 0 1 1\n2 0 1\n1 0 0 1 1 1 1 1\n\n-----Explanation-----\n\n\n\n\n\n\n\n\n\n\n\n\n1 \\le K$\n\n-----Explanation-----\n\n\n1\n\n1\n\n-----Explanation-----\n \\le A", "\n\n\n\n\n\n\n\n\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n\n1\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n-----Explanation-----\n\n\n\n\n\n \\le N$; $1"], "prompt": "\nQUESTION:\nChef has a sequence $A_1, A_2, \\ldots, A_N$; each element of this sequence is either $0$ or $1$. Appy gave him a string $S$ with length $Q$ describing a sequence of queries. There are two types of queries:\n- '!': right-shift the sequence $A$, i.e. replace $A$ by another sequence $B_1, B_2, \\ldots, B_N$ satisfying $B_{i+1} = A_i$ for each valid $i$ and $B_1 = A_N$\n- '?': find the length of the longest contiguous subsequence of $A$ with length $\\le K$ such that each element of this subsequence is equal to $1$\nAnswer all queries of the second type.\n\n-----Input-----\n- The first line of the input contains three space-separated integers $N$, $Q$ and $K$.\n- The second line contains $N$ space-separated integers $A_1, A_2, \\ldots, A_N$.\n- The third line contains a string with length $Q$ describing queries. Each character of this string is either '?', denoting a query of the second type, or '!', denoting a query of the first type.\n\n-----Output-----\nFor each query of the second type, print a single line containing one integer \u2014 the length of the longest required subsequence.\n\n-----Constraints-----\n- $1 \\le K \\le N \\le 10^5$\n- $1 \\le Q \\le 3 \\cdot 10^5$\n- $0 \\le A_i \\le 1$ for each valid $i$\n- $S$ contains only characters '?' and '!'\n\n-----Subtasks-----\nSubtask #1 (30 points):\n- $1 \\le N \\le 10^3$\n- $1 \\le Q \\le 3 \\cdot 10^3$\nSubtask #2 (70 points): original constraints \n\n-----Example Input-----\n5 5 3\n1 1 0 1 1\n?!?!?    \n\n-----Example Output-----\n2\n3\n3\n\n-----Explanation-----\n- In the first query, there are two longest contiguous subsequences containing only $1$-s: $A_1, A_2$ and $A_4, A_5$. Each has length $2$.\n- After the second query, the sequence $A$ is $[1, 1, 1, 0, 1]$.\n- In the third query, the longest contiguous subsequence containing only $1$-s is $A_1, A_2, A_3$.\n- After the fourth query, $A = [1, 1, 1, 1, 0]$.\n- In the fifth query, the longest contiguous subsequence containing only $1$-s is $A_1, A_2, A_3, A_4$ with length $4$. However, we only want subsequences with lengths $\\le K$. One of the longest such subsequences is $A_2, A_3, A_4$, with length $3$.\nUse Standard Input format\nANSWER:\n"}}