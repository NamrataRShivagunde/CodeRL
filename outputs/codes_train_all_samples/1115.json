{"1115": {"code": ["\n\n-----Example Input-----\n\n\n\n\n-----Example Input-----\n\n1 0 1 1 1 1 1 1 1 1 1\n\n\n\n\n-----Example Output-----\n\n2 0 1 1 1 2 1 1 1 1 1\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n-----Explanation-----\n\nION:\nION:\n- The first", "\n\n\n\n\n\n\n\n\n1 2 3 4 5\n3 4 5\n6 2 3 4 5\n1 1 2 3 3 4 5\n1 2 2 3 4 5\n1 2 3 4 5\n\n-----Constraints-----\n\n\n\n\n\n\n\nION:\n\n\n\n\n\n\n\n\n\n\n-----Explanation-----\n\n\n\n:\nA_1 \\", "\n\n1\n2 4 5\n3 4 5\n\n-----Constraints-----\n\n- $1 \\le N \\le T \\le 1,000$\n\n\n\n\n\n\n\n\n\n\n1 2 4 3 3 4 5\n\n\nION:\nION:\n\n\n\n\n\n\n\n\n\n\n\n1 2 2 3 4 5\n\n\nION:\nION:", "ION:\nUse Standard Input formatQUESTION:\n2,000,000\nION:\nION:\nION:\n\nExample Input-----\n- $1 \\le N \\le 300,000$\n\n\nION:\nION:\n\n\nION:\nION:\nION:\n\nION:\nION:\n\n\nION:\n\n\nION:\nION:\nYou are", ":\n\n\n1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n\n-----Constraints-----\n\n\n\n\n\n\n\n:\n\n\n\n\n1 1 1 2 1 1 1 1\n2 1 2 2 1 1 1\n\nION:\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nION:\nYou are given a", ":\n\n\n\n\n\n0 \\cdot 10^5$\n1 \\cdot 100 \\cdot 100 \\cdot 100\n\n-----Constraints-----\n\n\n\n\n\n\n\n\n1 1 2 3 4 5\n\n\n\n\nION:\n\n\n\n\n\n\n\n\n\n1 \\le 1$\n1 \\le 1$\n\n\nION:\nION:", "\n\n\n\n\n\n\n\n1\n2 3 4 5 6 7 7\n2 5 5\n3 3 4 5\n6 7 5\n15\n\n-----Example Input-----\n\n\n\n\n\n1 2 2 3 4 5 5\n1 2 2 3\nION:\nION:\n\n\n\n\n\n\n\n\n\n\n\n\n\n-----Explanation-----\nION:\nBy", "ION:\nUse Standard Input formatQUESTION:\n1 \\le N \\le T \\le 300,000$\nION:\nION:\nION:\n\n\n\nION:\nION:\n1\n2\n2 3 4 5\n5\nION:ION:\nION:\n\nION:\nION:\n\n\nION:\n\n\nION:\nION:\nYou are given", ":\n\n\nA:\nA:\nA:\nA:\nA:\nA:\nA:\nA:\nA:\nA:\n\n-----Constraints-----\n\n\n:\n\n\n\n\n\n\n\n:\n:\n\n\n:ION:\nION:\n\n\n\n\n\n\n\n\n\n\n-\n\nION:\nION:\n- The first", "\n\n\n\n\n-----Explanation-----\n\nExample input format\n\n\n\n\n-----Constraints-----\n- The first line contains a single integer $N$ denoting the number of test cases.\n\n\n-----Explanation-----\n\n\n\n\n\n\n\n\n\nION:\n\n\n\n\n\n\n\n\n\n\n\n\nION:\n\nION:\n\nA_1", "ION:\nUse Standard Input formatQUESTION:\n1 \\le N \\le T \\le 300,000$\nION:\nION:\nION:\n\n\n-----Example Input-----\n\nION:ION:\n\n\nION:\nION:\nION:\n\nION:\nION:\n\n\nION:\n\n\n9\n\n-----Explanation-----\nION:\nION:", "ION:\nUse Standard Input format\nION:\nN \\le 2,000\nION:\nION:\nION:\n\nExample Case 1:\n- $1 \\le N \\le 2,000$\n\n\nION:\nION:\n\n\nION:ION:\nION:\n\n\nION:\nION:\n\nION:\n-\nION:\nION:\nYou", "ION:\nUse Standard Input formatQUESTION:\nN \\le 1,000\nION:\nION:\nION:\n\n\n\n-----Example Input-----\n\n3\n3\n\n1\n2\n4\n5\n1\n2\n3\nION:\n\n\nION:\nION:\nION:\n\nION:ION:\\\nION:\n\n\nION:\nION", "ION:\nUse Standard Input formatQUESTION:\nN \\le 10^9 + 7$\nION:\nION:\nION:\n\n\n\nION:\nION:\n2\n1 2 3 4 5 5\nION:\nION:\nION:\n\n\nION:\nION:\n\n\nION:\n\n-----Input-----\n\n\nION:\nION:\nYou are", "ION:\n\nUse Standard Input format\nANSION:\n\n\n\n-----Explanation-----\nION:\n\nION:\n\n\n\n\n-----Constraints-----\n1\n2\n3 4 5\n\n\n-----Explanation-----\n\n\n\nION:\nION:\nION:\n\n\nION:\nION:\n\n\nION:\n\n\nION:\nION:\nYou", "\n\nN\n\n---\n\n\n\n-----Input-----\n\n\n\n\n\n-----Constraints-----\n\n\n1 1 2 3 4 5 5\n\n\n-----Explanation-----\n\n\n\n1 1 2 3 4 5\n1 1 2 2 3 4 5\n\n\nION:\n\n\n\n\n\n\n\n\n\n\n\n\n\nION:\n\nION:\nI can", "ION:\nUse Standard Input formatQUESTION:\nN \\le N \\le N \\le N \\le N \\le N$\nION:\nION:\nION:\n\n\n\nION:ION:\n\n\nION:\nION:\nION:\n\n\n\nION:\nION:\n1$\n\n\nION:\n\n1\nION:\nION:\nYou are", "ION:\nUse Standard Input formatQUESTION:\n1 \\le T \\le N \\le T \\le N \\le T \\le N \\le N$\nION:ION:\nION:\n\n\n-----Constraints-----\n-\n\nION:ION:\n\n\nION:ION:\nION:\n\nION:\nION:\n\nION\n\nION:\nION:\nYou", "\n\n\n\n\n\n\n\n1 4 3 4 5 5\n2 2 4 3 5 5\n5\n\n-----Constraints-----\n\n\n\n\n-----Explanation-----\n\n\n\n\n2 2 3 4 5\n2 2 4 5\n3 4 5 5\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n-----Explanation-----\n\n\n\nION:\nBy the", "ION:\nUse Standard Input formatQUESTION:\n1 \\le N \\le 300,000$\nION:\nION:\nION:\n\nConstraints:\n\n\n-----Constraints-----\n0\n\n-----Explanation-----\nION:ION:\n\n\nION:ION:\nION:\n\n\nION:\nION:\n\n\nION:\n\nION:\nION:\nBy"], "prompt": "\nQUESTION:\nYou are given a tree with $N$ vertices (numbered $1$ through $N$) and a sequence of integers $A_1, A_2, \\ldots, A_N$. You may choose an arbitrary permutation $p_1, p_2, \\ldots, p_N$ of the integers $1$ through $N$. Then, for each vertex $i$, you should assign the value $A_{p_i}$ to this vertex.\nThe profit of a path between two vertices $u$ and $v$ is the sum of the values assigned to the vertices on that path (including $u$ and $v$).\nLet's consider only (undirected) paths that start at a leaf and end at a different leaf. Calculate the maximum possible value of the sum of profits of all such paths. Since this value could be very large, compute it modulo $10^9 + 7$.\n\n-----Input-----\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\n- The first line of each test case contains a single integer $N$.\n- The second line contains $N$ space-separated integers $A_1, A_2, \\ldots, A_N$.\n- Each of the following $N\u22121$ lines contains two space-separated integers $u$ and $v$ denoting that vertices $u$ and $v$ are connected by an edge.\n\n-----Output-----\nFor each test case, print a single line containing one integer \u2014 the maximum sum of profits, modulo $10^9 + 7$.\n\n-----Constraints-----\n- $1 \\le T \\le 1,000$\n- $1 \\le N \\le 300,000$\n- $1 \\le A_i \\le 10^9$ for each valid $i$\n- the sum of $N$ over all test cases does not exceed $5 \\cdot 10^5$\n\n-----Example Input-----\n2\n4\n1 2 3 4\n1 2\n2 3\n2 4\n5\n1 2 3 4 5\n1 2\n2 3\n3 4\n4 5\n\n-----Example Output-----\n24\n15\n\n-----Explanation-----\nExample case 1: $(1, 4, 2, 3)$ is one of the possible permutations that give the optimal answer. Then, the profits of paths between pairs of vertices $(1, 3)$, $(1, 4)$ and $(3, 4)$ are $7$, $8$ and $9$ respectively.\nExample case 2: Here, any permutation could be chosen.\nUse Standard Input format\nANSWER:\n"}}