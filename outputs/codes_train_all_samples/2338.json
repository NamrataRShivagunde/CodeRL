{"2338": {"code": ["\n\n\n\n\n\n-----Note-----\n\n\n\n\n\n\n\n\n\n1\n\n\n-----Note-----\n\nThis is a generalization of the problem.\n\nNote:\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n-----Note-----\n\nThe first line contains a single integer $t$.\n\n\n\n\n\n1", "\n\n\n\n\n-----Note-----\n\n\n\n\n\n\n\n\n\n\n\n\n  1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n-----Note-----\n\n\n\n\n\n\n-----Note-----\n\n\n\n-----Example", "\n\n\n\n\n\n\n\n\n\n-----Note-----\n\n\n\n\n1\n2\n\n\n\n\n\n\n1\n2 1\n1\n1\n1\n\n\n-----Note-----\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n-----Note-----\n\n\n\n1\n\n\n\n-----Note-----\n\n\nThe first", "\n\n\n\n-----Note-----\n\nThis is a hard version\n\nExample:\n\n\n-----Input-----\n\n\n\n\n-----Note-----\n\n\n\n\n\n\n\n\n\n\n\n\n1\n\n\n-----Note-----\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n-----Note-----\n\n\n\n\n\n\n-----Note-----\n", "\n\n\n-----Note-----\n\n\n\n\n\n\n\nExample-----\n\nA problem is solved.\n\n\n-----Note-----\n\nThe problem is solved:\n\n\n\n\n-----Example-----\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n011\\to", "\n\n\n\n\n-----Note-----\n\n\n\n\nExample-----\n\nInput:\n1 1 2 3 3 2\n\nExample:\n\n1 1 1 2 3 2\n\nNote:\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n1\n\n\n\n\n\n\n-----Note-----\n", "\n\n-----Note-----\n\n\n\n\n\n\n\nExample-----\n\nA test case is solved from the hard version\n\nExample:\n\nA test case is solved from the hard version\n\nExample:\n\n-----Input-----\n\nA test case is solved from the hard version\n\nA test case\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n", "\n\n\n\n\n-----Note-----\n\n\n\n\n\nExample-----\n\nThe first line contains a single integer $k$ and the second line contains a binary string $b$.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n-----Note-----\n\n\n\n\n-----Note-----\n\n\n\n\n\n\n\n01011\\to 0", "\n\n\n\n-----Note-----\n\nThe function will never be called.\n\n\n-----Note-----\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n-----Note-----\n\n\nThis is the hard version.\n\n\n\n\n\n\n\n-----Note-----\n\n\n\n\n\n\n", "\n\n\n\n\n-----Note-----\n\n\n\nExample-----\n\nThe problem is solved in the form:\n\n-----Note-----\n\n\nThe problem is solved in the form of:\n\n\n\n\n\n\n\n-----Note-----\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n-----Note-----\n\n\n\n\n\n\n\n", "\n\n\n\n-----Note-----\n\nThe first line of the problem is the problem.\n\nNote:\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n-----Note-----\n\nThis task is a hard version of the problem.\n\nNote:\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n-----Note", "\n\n\n\n-----Note-----\n\nNote:\n\nThe problem is solved.\n\n-----Note-----\n\n\n\n\n\n\n\n\n\n\n\n\n1\n\n\n-----Note-----\n\n\n\n\n\n\n\n-----Note-----\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n.\n\n\n\n\n\n\n\n\n\n", "\n\n\n\n\n\n\n\nExample-----\n\nA test case is solved:\n\n-----Input-----\n\nThe number of test cases is 1, 2, 3, 9, 10, 11, 101\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n-----Note-----\n\n", "\n\n\n\n\n-----Note-----\n\n\n\n\n-----Note-----\n\nThe function is not able to make a problem.\n\nNote:\n\n\n\n\n\n-----Note-----\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n-----Note-----\n\n\n\n-----Example-----\n\n\n\n\n\n\n-----Note-----\n\n\n\n", "\n\n\n\n-----Note-----\n\nThe version is hard\n\nNote:\n\n\n\n\n\n\nExample-----\n\nInput\n2\n2\n2\n2\n\n\n\n\n\n-----Note-----\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n-----Note-----\n\n\n\n\n\n\n\n\nThe", "\n\n\n\n\n\n\n\nExample-----\n\nThe problem is solved as follows:\n\n-----Note-----\n\nThis task is solved as follows:\n\n\n-----Input-----\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n-----Note-----\n", "\n\n-----Note-----\n\n\n\n\n\n\nNote-----\n\nThis is the hard version\n\nExample:\n\n-----Input-----\n\nThis is the hard version\n\nExample:\n\n\n-----Input-----\n\n1\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n-----Note-----", "\n\n\n\n-----Note-----\n\nThis task is not possible with very long strings.\n\n\n\n\n\n\n\n\n\n-----Note-----\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n-----Note-----\n\nNote:\n\n\n\n\n-----Note-----\n\nThe result is:\n\n\n\n\n\n0101010101", "\n\n-----Note-----\n\n\n\n\n\n\n\n\n\n\n\n\n1\n\n2\n\n3\n\n2\n\n1\n\n2\n\n1\n\n\n-----Note-----\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n1$\n\n\n-----Note-----\n\n\n\n\n\n\n\n\n\n\n\n\n\n-----Example-----", "\n\n\n\n-----Note-----\n\nThis is a problem.\n\nNote:\n\n\n-----Input-----\n\nThe first line contains two binary strings\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n-----Note-----\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n-----Note-----\n\n\nThe"], "prompt": "\nQUESTION:\nThis is the hard version of the problem. The difference between the versions is the constraint on $n$ and the required number of operations. You can make hacks only if all versions of the problem are solved.\n\nThere are two binary strings $a$ and $b$ of length $n$ (a binary string is a string consisting of symbols $0$ and $1$). In an operation, you select a prefix of $a$, and simultaneously invert the bits in the prefix ($0$ changes to $1$ and $1$ changes to $0$) and reverse the order of the bits in the prefix.\n\nFor example, if $a=001011$ and you select the prefix of length $3$, it becomes $011011$. Then if you select the entire string, it becomes $001001$.\n\nYour task is to transform the string $a$ into $b$ in at most $2n$ operations. It can be proved that it is always possible.\n\n\n-----Input-----\n\nThe first line contains a single integer $t$ ($1\\le t\\le 1000$) \u00a0\u2014 the number of test cases. Next $3t$ lines contain descriptions of test cases.\n\nThe first line of each test case contains a single integer $n$ ($1\\le n\\le 10^5$) \u00a0\u2014 the length of the binary strings.\n\nThe next two lines contain two binary strings $a$ and $b$ of length $n$.\n\nIt is guaranteed that the sum of $n$ across all test cases does not exceed $10^5$.\n\n\n-----Output-----\n\nFor each test case, output an integer $k$ ($0\\le k\\le 2n$), followed by $k$ integers $p_1,\\ldots,p_k$ ($1\\le p_i\\le n$). Here $k$ is the number of operations you use and $p_i$ is the length of the prefix you flip in the $i$-th operation.\n\n\n-----Example-----\nInput\n5\n2\n01\n10\n5\n01011\n11100\n2\n01\n01\n10\n0110011011\n1000110100\n1\n0\n1\n\nOutput\n3 1 2 1\n6 5 2 5 3 1 2\n0\n9 4 1 2 10 4 1 2 1 5\n1 1\n\n\n\n-----Note-----\n\nIn the first test case, we have $01\\to 11\\to 00\\to 10$.\n\nIn the second test case, we have $01011\\to 00101\\to 11101\\to 01000\\to 10100\\to 00100\\to 11100$.\n\nIn the third test case, the strings are already the same. Another solution is to flip the prefix of length $2$, which will leave $a$ unchanged.\nUse Standard Input format\nANSWER:\n"}}