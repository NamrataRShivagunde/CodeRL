{"7": {"code": ["\n\n\n\n-----Note-----\n\nThe description of the test case is used.\n\n-----Note-----\n\n\n\n\n\n\n\n\n\n\n-----Example-----\n\n\n0 1 1 1 2 1 1 1 1 1 1 1 1\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n9\n\n\n2 1 2", "\n\n\n\n-----Note-----\n\nThe number of test cases is a total of five voters\n\n-----Note-----\n\n\n\n\n\n\n\n\n\n\n\n\n\n-----Note-----\n\n\n\n\n\n\n\n\n\n-----Note-----\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n6\n", "\n\n-----Note-----\n\n\n\n\n-----Note-----\n\n\n\n\n\n\n\n-----Input-----\n\nThe input is the number of coins you have to vote for you.\n\n-----Output-----\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n3\n\n\n\n-----Note-----\n", "\n\n-----Note-----\n\nThe number of voters is up to 10^9.\n\n-----Note-----\n\n\n\n\n\n\n\n\n\n\n\n3\n\n5\n6\n\n\n-----Note-----\n\n\n\n\n\n\n\n\n-----Note-----\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n2\n\n 1 10\n", "\n\n-----Note-----\n\n\n\n\n\n\n\n\n\n\n\n1\n2\n2\n1\n3\n4\n5\n6\n5\n5\n6\n3\n5\n7\n5\n\n\n\n-----Note-----\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n-----Note-----\n", "\n\n\n1 \\cdot 10^9\n1 \\cdot 10^9\n1 \\cdot 10^9\n1 \\cdot 10^9\n1\n\n\n\n\n\n\n\n\n\n\n\n-----Note-----\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n 3\n", "\n\n\n\n-----Note-----\n\nThe number of test cases is not the same as the number of test cases.\n\n-----Note-----\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n-----Note-----\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n2\n3\n4\n\n2", "\n\n-----Note-----\n\n\n\n\n\n\n\n\n-----Input-----\n\nTodo:\n\n\n0\n3\n2\n4\n5\n6\n5\n6\n4\n7\n5\n8\n\n\n\n\n\n\n\n\n-----Note-----\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n-----Note-----\n", "\n\n\n1 \\cdot 10^9\n1 \\cdot 10^8\n1 \\cdot 10^9\n1 \\cdot 10^9\n1\n\n\n\n\n\n\n\n\n\n\n\n\n-----Note-----\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n1\n2\n", "\n\n-----Note-----\n\n\n\n\n\n\n\n-----Input-----\n\nThe number of test cases\n\n\n\n\n5\n6\n5\n7\n\n\n-----Note-----\n\n\n\n\n2 5\n\n\n\n-----Example-----\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n2\n\n\n\n\n\n-----Note-----\n\n", "\n\n\n\n\n-----Note-----\n\nThe test cases have to be tested.\n\n\n\n\n\n\n-----Input-----\n\nThe number of voters are the number of test cases\n\n0 1 2\n\n1 1 2\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n2\n6\n4", "\n\n\n\n-----Note-----\n\nThe minimum number of coins you have to spend is 20, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n2\n\n\n 1", "\n\n\n\n\n\n\n\n-----Note-----\n\nThe first test case is not a test case.\n\nNote:\n\nThe second test case is a test case.\n\n-----Input-----\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n-----Note-----\n\n\n\n\n\n\n\n\n\n\n\n\n\n6\n1 1 2 3 4", "\n\n-----Note-----\n\nThe minimum number of coins you have to spend is the same as the minimum number of test cases.\n\nNote\n\n\n\n\n\n\n\n\n\n\n\n-----Note-----\n\n\n\n\n\n\n\n-----Note-----\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n3\n4", "\n\n-----Note-----\n\n\n\n\n\n-----Note-----\n\n\n\n\n\n\n\n-----Input-----\n\nThe first line of the test case contains one integer \u2014 number of coins\n\n2 \\cdot 10^9\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n3\n4\n\n", "\n\n\n\n-----Input-----\n\nThe number of coins you have to spend.\n\n-----Note-----\n\n\n\n\n-----Note-----\n\n\n\n\n\n\n\n\n\n\n-----Example-----\n\n\n\n\n\n\n-----Note-----\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n-----", "\n\n\n\n\n-----Note-----\n\n\n\n\n\n\n\n\n0\n1\n2\n3\n5\n2\n\n\n-----Note-----\n\n\n\n\n\n\n2 1\n\n5\n4\n5\n\n\n-----Note-----\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n-----Note-----\n", "\n\n\n\n-----Note-----\n\nThe first test case is used for the second test case.\n\n-----Note-----\n\n\n\n\n\n\n\n\n\n\n-----Example-----\n\n\n2\n\n\n\n-----Note-----\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n1 4 4", "\n\n\n\n\n\n-----Note-----\n\n\n\n\n\n\n1\n3\n2\n6\n0\n5\n5\n5\n\n\n-----Note-----\n\n\n1\n3\n\n\n-----Note-----\n\n\n\n\n\n\n\n-----Note-----\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n 2 2", "\n\n\n\n\n-----Note-----\n\n\n\n\n\n3\n0\n6\n\n7\n2\n6\n3\n4\n5\n\n\n-----Note-----\n\n\n2\n1\n2 5\n\n\n1\n1\n2\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n-----Note-----\n\n\n\n\n\n\n10\n2"], "prompt": "\nQUESTION:\nThe only difference between easy and hard versions is constraints.\n\nNow elections are held in Berland and you want to win them. More precisely, you want everyone to vote for you.\n\nThere are $n$ voters, and two ways to convince each of them to vote for you. The first way to convince the $i$-th voter is to pay him $p_i$ coins. The second way is to make $m_i$ other voters vote for you, and the $i$-th voter will vote for free.\n\nMoreover, the process of such voting takes place in several steps. For example, if there are five voters with $m_1 = 1$, $m_2 = 2$, $m_3 = 2$, $m_4 = 4$, $m_5 = 5$, then you can buy the vote of the fifth voter, and eventually everyone will vote for you. Set of people voting for you will change as follows: ${5} \\rightarrow {1, 5} \\rightarrow {1, 2, 3, 5} \\rightarrow {1, 2, 3, 4, 5}$.\n\nCalculate the minimum number of coins you have to spend so that everyone votes for you.\n\n\n-----Input-----\n\nThe first line contains one integer $t$ ($1 \\le t \\le 2 \\cdot 10^5$) \u2014 the number of test cases.\n\nThe first line of each test case contains one integer $n$ ($1 \\le n \\le 2 \\cdot 10^5$) \u2014 the number of voters.\n\nThe next $n$ lines contains the description of voters. $i$-th line contains two integers $m_i$ and $p_i$ ($1 \\le p_i \\le 10^9, 0 \\le m_i < n$).\n\nIt is guaranteed that the sum of all $n$ over all test cases does not exceed $2 \\cdot 10^5$.\n\n\n-----Output-----\n\nFor each test case print one integer \u2014 the minimum number of coins you have to spend so that everyone votes for you.\n\n\n-----Example-----\nInput\n3\n3\n1 5\n2 10\n2 8\n7\n0 1\n3 1\n1 1\n6 1\n1 1\n4 1\n4 1\n6\n2 6\n2 3\n2 8\n2 7\n4 4\n5 5\n\nOutput\n8\n0\n7\n\n\n\n-----Note-----\n\nIn the first test case you have to buy vote of the third voter. Then the set of people voting for you will change as follows: ${3} \\rightarrow {1, 3} \\rightarrow {1, 2, 3}$.\n\nIn the second example you don't need to buy votes. The set of people voting for you will change as follows: ${1} \\rightarrow {1, 3, 5} \\rightarrow {1, 2, 3, 5} \\rightarrow {1, 2, 3, 5, 6, 7} \\rightarrow {1, 2, 3, 4, 5, 6, 7}$.\n\nIn the third test case you have to buy votes of the second and the fifth voters. Then the set of people voting for you will change as follows: ${2, 5} \\rightarrow {1, 2, 3, 4, 5} \\rightarrow {1, 2, 3, 4, 5, 6}$.\nUse Standard Input format\nANSWER:\n"}}